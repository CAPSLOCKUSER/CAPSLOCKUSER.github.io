{"version":3,"sources":["../js/api.js"],"names":[],"mappings":";;AAAA,OAAO,CAAC,QAAD,EAAW,WAAX,CAAP,EAAgC,UAAC,CAAD,QAA2B;AAAA,MAArB,cAAqB,QAArB,cAAqB;;;AAEzD,WAAS,wBAAT,CAAkC,IAAlC,EAAwC;AACtC,WAAO,MAAM,OAAN,CAAc,IAAd,CAAP;AACD;;AAED,MAAM,YAAY,eAAe;AAC/B,QAAI,QAD2B;AAE/B,UAAM,QAFyB;AAG/B,YAAQ,SAHuB;AAI/B,WAAO,QAJwB;AAK/B,iBAAa,QALkB;AAM/B,aAAS,QANsB;AAO/B,aAAS,QAPsB;AAQ/B,cAAU;AACR,eAAS,QADD;AAER,YAAM,QAFE;AAGR,mBAAa,EAAE,UAAU,QAAZ,EAAsB,WAAW,QAAjC;AAHL,KARqB;AAa/B,YAAQ,CAAC,QAAD;AAbuB,GAAf,CAAlB;;AAgBA,WAAS,IAAT,CAAc,GAAd,EAAmB;AACjB,WAAO,IAAI,OAAJ,CAAY,UAAC,OAAD,EAAU,MAAV,EAAqB;AACtC,QAAE,IAAF,CAAO;AACH,gBADG;AAEH,kBAAU,OAFP;AAGH,iBAAS;AAHN,OAAP,EAKG,IALH,CAKQ,gBAAQ;AACZ,YAAI,CAAC,yBAAyB,IAAzB,CAAL,EAAqC;AACnC,iBAAO,iCAAP;AACA;AACD;AACD,YAAM,cAAc,KAAK,MAAL,CAAY,SAAZ,CAApB;AACA,gBAAQ,WAAR;AACD,OAZH,EAYK,MAZL;AAaD,KAdM,CAAP;AAeD;;AAED,SAAO;AACL;AADK,GAAP;AAGD,CA3CD","file":"api.js","sourcesContent":["define(['jquery', 'lib/utils'], ($, { validateObject }) => {\n\n  function isResponseInCorrectShape(data) {\n    return Array.isArray(data);\n  }\n\n  const validator = validateObject({\n    id: 'number',\n    type: 'string',\n    isLive: 'boolean',\n    title: 'string',\n    description: 'string',\n    viewers: 'number',\n    picture: 'string',\n    location: {\n      country: 'string',\n      city: 'string',\n      coordinates: { latitude: 'number', longitude: 'number' },\n    },\n    labels: ['string'],\n  });\n\n  function poll(url) {\n    return new Promise((resolve, reject) => {\n      $.ajax({\n          url,\n          dataType: 'jsonp',\n          timeout: 5000,\n        })\n        .then(data => {\n          if (!isResponseInCorrectShape(data)) {\n            reject('Server response is not an array');\n            return;\n          }\n          const correctList = data.filter(validator);\n          resolve(correctList);\n        }, reject);\n    });\n  }\n\n  return {\n    poll,\n  }\n});\n"]}